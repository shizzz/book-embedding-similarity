<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Похожие книги — {{ file }}
    </title><link rel="stylesheet" href="/static/css/style.css?v=0.2">
    <script defer src="/static/js/main.js?v=0.2"></script>
</head>
<body>
    <h1>Поиск похожих книг</h1>
    
    <p>Книга: <code id="book-file">{{ file }}</code></p>

    <div id="status" class="loading">Подготовка…</div>
    <div id="progress"></div>
    <div id="result"></div>

    <script>
        // Параметры из URL (передаются через Jinja или Query)
        const urlParams = new URLSearchParams(window.location.search);
        const file = "{{ file | e }}";  // экранирование на всякий случай
        const limit = {{ limit }};
        const exclude_same_author = {{ "true" if exclude_same_author else "false" }};
        const force = {{ "true" if force else "false" }};

        const es = new EventSource(
            `/similar/events?file=${encodeURIComponent(file)}&limit=${limit}&exclude_same_author=${exclude_same_author}&force=${force}`
        );
    </script>
</body>
</html>